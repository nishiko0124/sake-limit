<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sake Limit Pro - ã‚¿ãƒƒãƒ—å¼</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #2c3e50;
            color: #ecf0f1;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* ä¸Šå¯„ã›ã«å¤‰æ›´ */
            min-height: 100vh;
            margin: 0;
            padding: 20px 10px;
            box-sizing: border-box;
        }
        .container {
            background: #34495e;
            padding: 1.5rem;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            width: 100%;
            max-width: 420px;
            text-align: center;
        }
        h1 { margin: 0 0 1.5rem 0; font-size: 1.5rem; color: #f1c40f; letter-spacing: 1px;}

        /* ãƒ¡ãƒ¼ã‚¿ãƒ¼éƒ¨åˆ† */
        .meter-wrapper {
            background: #22303d;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 25px;
            border: 1px solid #46637f;
            position: sticky;
            top: 0;
            z-index: 10; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã‚‚æµ®ãã‚ˆã†ã« */
        }
        .meter-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: #bdc3c7;
        }
        .meter-container {
            height: 35px;
            background-color: #58636d;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
        }
        .meter-fill {
            height: 100%;
            width: 0%;
            background-color: #2ecc71;
            transition: width 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), background-color 0.4s;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 12px;
            font-weight: bold;
            font-size: 0.9rem;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        .status-message {
            margin-top: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            min-height: 1.5em;
        }

        /* ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ï¼ˆã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰ */
        .section-title {
            text-align: left;
            font-size: 0.9rem;
            color: #95a5a6;
            margin: 15px 0 5px 5px;
        }
        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2åˆ— */
            gap: 10px;
            margin-bottom: 20px;
        }
        .drink-btn {
            border: none;
            border-radius: 12px;
            padding: 15px 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            color: white;
            transition: transform 0.1s, opacity 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        .drink-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }
        .drink-btn small {
            font-size: 0.7rem;
            font-weight: normal;
            opacity: 0.9;
            margin-top: 3px;
        }

        /* è‰²åˆ†ã‘ */
        .btn-light { background-color: #3498db; } /* é’ï¼šæ™®é€š */
        .btn-strong { background-color: #e74c3c; } /* èµ¤ï¼šå¼·ã„ */
        .btn-water { background-color: #00cec9; color: #2d3436; grid-column: span 2; } /* æ°´ï¼šå…¨å¹… */

        /* æ°´ã‚¢ãƒ©ãƒ¼ãƒˆ */
        .water-alert {
            background: #e74c3c;
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            margin-bottom: 15px;
            display: none;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); }
        }

        /* ä¸‹éƒ¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */
        .footer-control {
            background: #2c3e50;
            padding: 15px;
            border-radius: 15px;
            margin-top: 20px;
        }
        input[type=range] { width: 100%; margin: 10px 0; accent-color: #f1c40f;}

        .log-area {
            text-align: left;
            font-size: 0.8rem;
            color: #7f8c8d;
            margin-top: 10px;
            max-height: 100px;
            overflow-y: auto;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ» Sake Limit Pro</h1>

    <div id="water-alert" class="water-alert">âš ï¸ æ°´ã‚’é£²ã‚“ã§ã‹ã‚‰1æ™‚é–“çµŒéï¼<br>æ°´ã‚’é£²ã¿ã¾ã—ã‚‡ã†ï¼</div>

    <div class="meter-wrapper">
        <div class="meter-header">
            <span>ãƒªãƒŸãƒƒãƒˆã¾ã§</span>
            <span id="score-display">0 / 100</span>
        </div>
        <div class="meter-container">
            <div id="meter-fill" class="meter-fill">0%</div>
        </div>
        <div id="status-message" class="status-message">ã‚·ãƒ©ãƒ•</div>
    </div>

    <div class="section-title">ğŸº ã‚¬ãƒ–ã‚¬ãƒ–ç³» (æ™®é€š)</div>
    <div class="button-grid">
        <button class="drink-btn btn-light" onclick="addDrink(25, 'ãƒ“ãƒ¼ãƒ«ä¸­')">
            ãƒ“ãƒ¼ãƒ«/ã‚µãƒ¯ãƒ¼
            <small>ä¸­ã‚¸ãƒ§ãƒƒã‚­ (25pt)</small>
        </button>
        <button class="drink-btn btn-light" onclick="addDrink(50, 'ã‚¹ãƒˆãƒ­ãƒ³ã‚°')">
            ã‚¹ãƒˆãƒ­ãƒ³ã‚°ç³»
            <small>ãƒ­ãƒ³ã‚°ç¼¶ (50pt)</small>
        </button>
    </div>

    <div class="section-title">ğŸ¶ ã¡ã³ã¡ã³ç³» (å¼·ã„)</div>
    <div class="button-grid">
        <button class="drink-btn btn-strong" onclick="addDrink(25, 'æ—¥æœ¬é…’(ãŠçŒªå£)')">
            æ—¥æœ¬é…’
            <small>ãŠçŒªå£1æ¯ (25pt)</small>
        </button>
        <button class="drink-btn btn-strong" onclick="addDrink(100, 'æ—¥æœ¬é…’(1åˆ)')">
            æ—¥æœ¬é…’
            <small>ä¸€åˆå¾³åˆ© (100pt)</small>
        </button>
        <button class="drink-btn btn-strong" onclick="addDrink(70, 'ãƒ¯ã‚¤ãƒ³(ã‚°ãƒ©ã‚¹)')">
            ãƒ¯ã‚¤ãƒ³
            <small>ã‚°ãƒ©ã‚¹1æ¯ (70pt)</small>
        </button>
        <button class="drink-btn btn-strong" onclick="addDrink(30, 'ã‚·ãƒ§ãƒƒãƒˆ')">
            æ´‹é…’ã‚·ãƒ§ãƒƒãƒˆ
            <small>ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ç­‰ (30pt)</small>
        </button>
    </div>

    <div class="section-title">ğŸ’§ å›å¾©</div>
    <div class="button-grid">
        <button class="drink-btn btn-water" onclick="addWater()">
            ãŠæ°´ã‚’é£²ã‚“ã  (å›å¾© -5pt)
        </button>
    </div>

    <div class="footer-control">
        <div style="display:flex; justify-content:space-between; font-size:0.9rem;">
            <label>é£²ã¿å§‹ã‚ã‹ã‚‰</label>
            <span id="time-display">0 æ™‚é–“</span>
        </div>
        <input type="range" id="timeSlider" min="0" max="8" step="0.5" value="0" oninput="updateTime(this.value)">
        <div class="log-area" id="log-area">å±¥æ­´: ãªã—</div>
    </div>
</div>

<script>
    let totalDrinkScore = 0;
    let waterScore = 0;
    let timeScore = 0;
    let lastWaterTime = Date.now();
    const MAX_LIMIT = 100;

    // 10ç§’ã”ã¨ã«æ°´ãƒã‚§ãƒƒã‚¯
    setInterval(() => {
        if (totalDrinkScore === 0) return; // é£²ã‚“ã§ãªã„ãªã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆãªã—

        const now = Date.now();
        const diffMinutes = (now - lastWaterTime) / 1000 / 60;
        const alertBox = document.getElementById('water-alert');

        // 60åˆ†çµŒéã§ã‚¢ãƒ©ãƒ¼ãƒˆ
        if (diffMinutes > 60) {
            alertBox.style.display = 'block';
        }
    }, 10000);

    function updateDisplay() {
        let currentScore = totalDrinkScore - waterScore - timeScore;
        if (currentScore < 0) currentScore = 0;

        const percentage = Math.min(currentScore, 100);
        const meter = document.getElementById('meter-fill');
        const status = document.getElementById('status-message');
        const scoreDisplay = document.getElementById('score-display');

        // ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        meter.style.width = percentage + '%';
        meter.innerText = Math.floor(percentage) > 10 ? Math.floor(percentage) + '%' : '';
        scoreDisplay.innerText = Math.floor(currentScore) + ' / ' + MAX_LIMIT;

        // çŠ¶æ…‹åˆ¤å®š
        if (currentScore >= 100) {
            meter.style.backgroundColor = '#e74c3c'; // Red
            status.innerText = "ğŸš¨ é™ç•Œçªç ´ï¼çµ‚äº†ï¼";
            status.style.color = '#e74c3c';
            shakeScreen(); // ç”»é¢ã‚’æºã‚‰ã™æ¼”å‡º
        } else if (currentScore >= 80) {
            meter.style.backgroundColor = '#e67e22'; // Orange
            status.innerText = "âš ï¸ ã‚‚ã†ã‚„ã°ã„ã€‚æ°´é£²ã‚“ã§ï¼";
            status.style.color = '#e67e22';
        } else if (currentScore >= 50) {
            meter.style.backgroundColor = '#f1c40f'; // Yellow
            status.innerText = "ğŸ¥´ ã»ã‚é…”ã„ã€‚ãƒšãƒ¼ã‚¹è½ã¨ã—ã¦";
            status.style.color = '#f1c40f';
        } else {
            meter.style.backgroundColor = '#2ecc71'; // Green
            status.innerText = "ğŸ˜Š ã¾ã ä½™è£•ã‚ã‚Š";
            status.style.color = '#2ecc71';
        }
    }

    function addDrink(points, name) {
        totalDrinkScore += points;
        addLog("ğŸº " + name + " (+" + points + ")");
        updateDisplay();

        // ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ„Ÿè§¦ï¼ˆãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šAndroidç­‰å¯¾å¿œæ©Ÿç¨®ã®ã¿ï¼‰
        if (navigator.vibrate) navigator.vibrate(50);
    }

    function addWater() {
        waterScore += 5; // å›å¾©é‡
        lastWaterTime = Date.now();
        document.getElementById('water-alert').style.display = 'none';

        addLog("ğŸ’§ ãŠæ°´ (-5)");
        updateDisplay();
        if (navigator.vibrate) navigator.vibrate(30);
    }

    function updateTime(val) {
        document.getElementById('time-display').innerText = val + " æ™‚é–“";
        timeScore = val * 15; // 1æ™‚é–“ã§15å›å¾©
        updateDisplay();
    }

    function addLog(msg) {
        const logArea = document.getElementById('log-area');
        const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        const newLog = `<div><span style="color:#95a5a6">${time}</span> ${msg}</div>`;

        if (logArea.innerHTML.includes('ãªã—')) {
            logArea.innerHTML = newLog;
        } else {
            logArea.innerHTML = newLog + logArea.innerHTML;
        }
    }

    function shakeScreen() {
        const container = document.querySelector('.container');
        container.style.transform = 'translate(5px, 5px)';
        setTimeout(() => container.style.transform = 'translate(-5px, -5px)', 50);
        setTimeout(() => container.style.transform = 'translate(5px, -5px)', 100);
        setTimeout(() => container.style.transform = 'translate(0, 0)', 150);
    }
</script>

</body>
</html>
